mimodificada=function(X,Y,ensy){
U <- cbind(Y, X)
Hx <- .Call("entropyR",X, ensy, 1, 2, DUP = FALSE, PACKAGE = "infotheo")
Hy <- .Call("entropyR",Y, ensy, 1, 2, DUP = FALSE, PACKAGE = "infotheo")
Hyx <- .Call("entropyR",U, ensy, 2, 2, DUP = FALSE, PACKAGE = "infotheo")
res <- Hx + Hy - Hyx
res
}
w<-1:25
w
z <- scan()
x <- c(3,8,9,6,4,5)
y <- seq(1, 20, 2)
library("genefilter")
tab  <- read.table("Desktop/Blast_Gold_standard/Results/Gen-Gen_similarity.matrix")
tab[c(8200:8212),c(8200:8212)]
mini <- tab[c(8200:8212),c(8200:8212)]
View(mini)
tab  <- read.table("Desktop/Blast_Gold_standard/Results/Gen-Gen_adjacency.matrix")
View(tab)
mini <- tab[c(9800:9829),c(1:12)]
View(mini)
View(tab)
tab  <- read.table("Desktop/Blast_Gold_standard/Results/Gen-Gen_similarity.matrix")
View(tab)
mini <- tab[c(8200:8212),c(8200:8212)]
View(mini)
tab  <- read.table("Desktop/Blast_Gold_standard/Results/Gen-Gen_similarity.matrix")
View(tab)
tab  <- read.table("Desktop/Blast_Gold_standard/Results/Gen-Gen_similarity.matrix", header=TRUE)
View(tab)
citation("Agi4x44PreProcess")
source("http://bioconductor.org/biocLite.R")
citation("Agi4x44PreProcess")
biocLite("Agi4x44PreProcess")
citation("Agi4x44PreProcess")
source("http://bioconductor.org/biocLite.R")
biocLite("marray")
citation("marray")
x  <- c(3.9        3.5        1.2        0.0        2.4        3.4        3.4        2.9        1.2        3.4        2.2        2.5        0.0        4.5        3.9        2.7        1.4        3.5        2.0        2.7        2.9        2.2        3.5        4.7        3.2        2.4        3.7        0.0        1.2        0.0        2.4        1.2        1.7        3.0        0.0        0.0        2.9        2.4        2.4        0.0        4.2        3.9        2.4        4.5        4.2        1.9        0.0        4.4        0.0        3.5        5.0        3.9        1.2        1.4        1.2        1.2        4.2        3.4        3.5        1.7        5.0        3.5        2.4        4.4        3.7        0.0        1.9        1.2        3.5        1.2        0.0        0.0        2.4        0.0        4.2        2.0        0.0        5.0        2.4        2.7        1.2        5.0        4.9        0.0        2.7        1.2        3.5)
x <- c(3.9,3.5,1.2,0.0,2.4,3.4,3.4,2.9,1.2,3.4,2.2,2.5,0.0,4.5,3.9,2.7,1.4,3.5,2.0,2.7,2.9,2.2,3.5,4.7,3.2,2.4,3.7,0.0,1.2,0.0,2.4,1.2,1.7,3.0,0.0,0.0,2.9,2.4,2.4,0.0,4.2,3.9,2.4,4.5,4.2,1.9,0.0,4.4,0.0,3.5,5.0,3.9,1.2,1.4,1.2,1.2,4.2,3.4,3.5,1.7,5.0,3.5,2.4,4.4,3.7,0.0,1.9,1.2,3.5,1.2,0.0,0.0,2.4,0.0,4.2,2.0,0.0,5.0,2.4,2.7,1.2,5.0,4.9,0.0,2.7,1.2,3.5)
barplot(x)
boxplot(x)
barplot(summary(x))
barplot(summary(as.factor(x))
)
barplot(summary(as.factor(x)))
rank (x)
hist(x)
hist(x, breaks=4)
hist(x, breaks=9)
nzmean <- function(x) {
if (all(x==0)) 0 else mean(x[x!=0])
}
apply(x,1,nzmean)
x[x == 0] <- NA
x
hist(x, breaks=9)
mean(x=x,na.rm=T)
mean(x=x,na.rm=F)
x <- c(3.9,3.5,1.2,0.0,2.4,3.4,3.4,2.9,1.2,3.4,2.2,2.5,0.0,4.5,3.9,2.7,1.4,3.5,2.0,2.7,2.9,2.2,3.5,4.7,3.2,2.4,3.7,0.0,1.2,0.0,2.4,1.2,1.7,3.0,0.0,0.0,2.9,2.4,2.4,0.0,4.2,3.9,2.4,4.5,4.2,1.9,0.0,4.4,0.0,3.5,5.0,3.9,1.2,1.4,1.2,1.2,4.2,3.4,3.5,1.7,5.0,3.5,2.4,4.4,3.7,0.0,1.9,1.2,3.5,1.2,0.0,0.0,2.4,0.0,4.2,2.0,0.0,5.0,2.4,2.7,1.2,5.0,4.9,0.0,2.7,1.2,3.5)
mean(x)
y[x == ]  <- NA
y[x == 0]  <- NA
library("ade4", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
data(jv73)
Sys.setenv(http_proxy="http://afquinteromo:2012Drauglyafqm@168.176.55.63:8080")
data(jv73)
kta1 <- ktab.within(withinpca(jv73$morpho, jv73$fac.riv, scann = FALSE))
library(ad4)
library(ade4)
library(sp)
rm (jv73,kta1)
data(jv73)
install.packages("sp")
rm (jv73,kta1)
install.packages("sp")
library(sp)
data(jv73)
kta1 <- ktab.within(withinpca(jv73$morpho, jv73$fac.riv, scann = FALSE))
statis1 <- statis(kta1, scann = FALSE)
plot(statis1)
class(jv73$morpho)
jv73$morpho
dudi1 <- dudi.pca(jv73$poi, scann = FALSE, scal = FALSE)
wit1 <- wca(dudi1, jv73$fac.riv, scann = FALSE)
kta3 <- ktab.within(wit1)
data(jv73)
statis3 <- statis(kta3, scann = FALSE)
plot(statis3)
s.arrow(statis3$C.li, cgrid = 0)
kplot(statis3, traj = TRUE, arrow = FALSE, unique = TRUE,
clab = 0, csub = 3, cpoi = 3)
statis3
jv73
jv73$morpho
jv73$phychi
statis3
jv73$morpho
jv73$phychi
jv73$fac.riv
Sys.setenv(http_proxy="http://afquinteromo:2012Drauglyafqm@168.176.55.63:8080")
source("http://bioconductor.org/biocLite.R")
biocLite("affy")
Sys.getenv("http_proxy")
library(CLL)
biocLite("CLL")
biocLite("affydata")
source("http://bioconductor.org/biocLite.R")
biocLite("multtest")
source("http://bioconductor.org/biocLite.R")
library(multtest)
biocLite("multtest")
source("http://bioconductor.org/biocLite.R")
library(ade4)
library(sp)
data(jv73)
class(jv73)
ls(jv73)
kta1 <- ktab.within(withinpca(jv73$morpho, jv73$fac.riv, scann = FALSE))
statis1 <- statis(kta1, scann = FALSE)
plot(statis1)
dudi1 <- dudi.pca(jv73$poi, scann = FALSE, scal = FALSE)
wit1 <- wca(dudi1, jv73$fac.riv, scann = FALSE)
kta3 <- ktab.within(wit1)
data(jv73)
statis3 <- statis(kta3, scann = FALSE)
plot(statis3)
s.arrow(statis3$C.li, cgrid = 0)
kplot(statis3, traj = TRUE, arrow = FALSE, unique = TRUE,
clab = 0, csub = 3, cpoi = 3)
statis3
ls(jv73)
jv73$morpho
jv73$contour
jv73$fac.riv
jv73$morpho
jv73$phychi
jv73$poi
jv73$Spatial
jv73$xy
class(kta1)
kta1
ls(kta1)
class(statis1)
statis1
source("http://bioconductor.org/biocLite.R")
library("GWASTools")
data(affyScanADF)
samp.chr.matrix <- matrix(TRUE,nrow(affyScanADF),26)
dup <- duplicated(affyScanADF$subjectID)
ibrary(GWASdata)
library(GWASdata)
data(affyScanADF)
samp.chr.matrix <- matrix(TRUE,nrow(affyScanADF),26)
dup <- duplicated(affyScanADF$subjectID)
samp.chr.matrix[dup | is.na(affyScanADF$sex),] <- FALSE #identified duplicated data and missing
samp.chr.matrix[affyScanADF$sex=="F", 25] <- FALSE
# additionally, exclude YRI subjects
scan.exclude <- affyScanADF$scanID[affyScanADF$race == "YRI"]
affyScanADF$age <- rnorm(nrow(affyScanADF),mean=40, sd=10)
affyScanADF$event <- rbinom(nrow(affyScanADF),1,0.4)
affyScanADF$ttoe <- rnorm(nrow(affyScanADF),mean=100,sd=10)
# create data object
ncfile <- system.file("extdata", "affy_geno.nc", package="GWASdata")
nc <- NcdfGenotypeReader(ncfile)
genoData <-  GenotypeData(nc, scanAnnot=affyScanADF)
source("http://bioconductor.org/biocLite.R")
?BiocUpgrade
biocLite("BiocUpgrade")
library("ade4", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
detach("package:ade4", unload=TRUE)
ibrary("GWASTools")
?assocTestCPH
# an example of a scan chromosome matrix
# desiged to eliminate duplicated individuals
# and scans with missing values of sex
#biocLite("GWASdata")
library(GWASdata)
data()
data(affyScanADF)
samp.chr.matrix <- matrix(TRUE,nrow(affyScanADF),26)
dup <- duplicated(affyScanADF$subjectID)
samp.chr.matrix[dup | is.na(affyScanADF$sex),] <- FALSE #identified duplicated data and missing
samp.chr.matrix[affyScanADF$sex=="F", 25] <- FALSE
# additionally, exclude YRI subjects
scan.exclude <- affyScanADF$scanID[affyScanADF$race == "YRI"]
# create some variables for the scans
affyScanADF$age <- rnorm(nrow(affyScanADF),mean=40, sd=10)
affyScanADF$event <- rbinom(nrow(affyScanADF),1,0.4)
affyScanADF$ttoe <- rnorm(nrow(affyScanADF),mean=100,sd=10)
# create data object
ncfile <- system.file("extdata", "affy_geno.nc", package="GWASdata")
nc <- NcdfGenotypeReader(ncfile)
genoData <-  GenotypeData(nc, scanAnnot=affyScanADF)
ncfile <- tempfile()simulateGenotypeMatrix(n.snps=10, n.chromosomes=40, n.samples=5,                       ncdf.filename=ncfile)nc <- NcdfGenotypeReader(ncfile, autosomeCode=1:38L,                         XchromCode=39L, YchromCode=40L,                         XYchromCode=41L, MchromCode=42L)table(getChromosome(nc))table(getChromosome(nc, char=TRUE))# SNP annotationsnpdf <- data.frame(snpID=getSnpID(nc),                    chromosome=getChromosome(nc),                    position=getPosition(nc))snpAnnot <- SnpAnnotationDataFrame(snpdf, autosomeCode=1:38L,                                   XchromCode=39L, YchromCode=40L,                                   XYchromCode=41L, MchromCode=42L)varMetadata(snpAnnot)[,"labelDescription"] <-  c("unique integer ID",    "chromosome coded as 1:38=autosomes, 39=Z, 40=W",    "base position")# reverse sex coding to get proper counting of sex chromosome SNPsscandf <- data.frame(scanID=1:5, sex=c("M","M","F","F","F"),                     stringsAsFactors=FALSE)scanAnnot <- ScanAnnotationDataFrame(scandf)varMetadata(scanAnnot)[,"labelDescription"] <-  86genotypeToCharacterc("unique integer ID",  "sex coded as M=female and F=male")genoData2 <- GenotypeData(nc, snpAnnot=snpAnnot, scanAnnot=scanAnnot)
ncfile <- tempfile()
simulateGenotypeMatrix(n.snps=10, n.chromosomes=40, n.samples=5,
ncdf.filename=ncfile)
nc <- NcdfGenotypeReader(ncfile, autosomeCode=1:38L,
XchromCode=39L, YchromCode=40L,
XYchromCode=41L, MchromCode=42L)
table(getChromosome(nc))
table(getChromosome(nc, char=TRUE))
# SNP annotation
snpdf <- data.frame(snpID=getSnpID(nc),
chromosome=getChromosome(nc),
position=getPosition(nc))
snpAnnot <- SnpAnnotationDataFrame(snpdf, autosomeCode=1:38L,
XchromCode=39L, YchromCode=40L,
XYchromCode=41L, MchromCode=42L)
varMetadata(snpAnnot)[,"labelDescription"] <-
c("unique integer ID",
"chromosome coded as 1:38=autosomes, 39=Z, 40=W",
"base position")
# reverse sex coding to get proper counting of sex chromosome SNPs
scandf <- data.frame(scanID=1:5, sex=c("M","M","F","F","F"),
stringsAsFactors=FALSE)
scanAnnot <- ScanAnnotationDataFrame(scandf)
varMetadata(scanAnnot)[,"labelDescription"] <-
86
genotypeToCharacter
c("unique integer ID",
"sex coded as M=female and F=male")
genoData2 <- GenotypeData(nc, snpAnnot=snpAnnot, scanAnnot=scanAnnot)
genoData
genoData2
genoData$event
affyScanADF$event
nc$event
View(scandf)
genotypeToCharacter
ScanAnnotationDataFrame(scandf)
scanAnnot
affyScanADF$ttoe
affyScanADF$age
?assocTestCPH
warning()
warnings()
chisq.test(c(22,15,4,5,30,19,9,2), p=c(3/16,3/16,1/16,1/16,3/16,3/16,1/16,1/16))
chisq.test(c(222,15,4,5,30,19,9,2), p=c(3/16,3/16,1/16,1/16,3/16,3/16,1/16,1/16))
read.table("Desktop/Conteos.txt")
read.table("Desktop/Conteos.txt", header = T)
read.table("Desktop/Conteos.txt", header = T)
read.table("Desktop/Conteos.txt", header = T)
x <- read.table("Desktop/Conteos.txt", header = T)
chisq.test(x$rep1, p=x$frec_esp)
chisq.test(x$rep1, p=as.numeric(x$frec_esp))
as.numeric(x$frec_esp)
chisq.test(c(22,15,4,5,30,19,9,2), p=c(3/16,3/16,1/16,1/16,3/16,3/16,1/16,1/16))
class(x$frec_esp)
as.matrix(x)
as.numeric(x)
x <- as.matrix(x)
x[4]
x[,4]
chisq.test(c(22,15,4,5,30,19,9,2), p=c(3/16,3/16,1/16,1/16,3/16,3/16,1/16,1/16))
chisq.test(x[,1], p=x[,4])
x[,1]
x <- read.table("Desktop/Conteos.txt", header = T, stringsAsFactors=F)
class(x$frec_esp)
chisq.test(x$rep1, p=as.numeric(x$frec_esp))
x
as.numeric(x$frec_esp)
chisq.test(c(x[,1]), p=c(x[,4]))
library("DESeq2", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
install.packages("rJava")
library(rJava)
.jinit()
.jaddClassPath(path="Downloads/imzMLConverter_1.3/imzMLConverter.jar")
filename <- "Metabolomics_UR/Metabolomic_DESI/20142305WT551M41201.imzML";
imzML <- J("imzMLConverter.ImzMLHandler")$parseimzML(filename)
width <- J(imzML, 'getWidth')
height <- J(imzML, 'getHeight')
x <- 1;
y <- 1;
spectrum <- J(imzML, 'getSpectrum', as.integer(x), as.integer(y))
mzs <- J(spectrum, 'getmzArray')
counts <- J(spectrum, 'getIntensityArray')
plot(mzs, counts, "l")
source("http://bioconductor.org/biocLite.R")
biocLite("Risa")
c(82.31023894,70.61975936,65.20903658)
t.test(c(82.31023894,70.61975936,65.20903658),c(2.286276671, 2.321407829, 2.323017464))
t.test(c(82.31023894,70.61975936,65.20903658),c(2.286276671, 2.321407829, 2.323017464), paired = FALSE, alternative="two.sided")
biocLite("xcms")
biocLite("CAMERA")
biocLite("CAMERA")
biocLite("CAMERA")
biocLite("Heatplus")
biocLite("Heatplus")
biocLite("Heatplus")
biocLite("Heatplus")
install.packages("snow")
install.packages("snow")
install.packages("pcaMethods")
biocLite("pcaMethods")
install.packages("sp")
detectCores()
library(Risa)
library(snow)
library(xcms)
library(CAMERA)
library(pcaMethods)
library(Heatplus)
library(sp)
detectCores()
substr("aaaadddddfffff")
substr("aaaadddddfffff", 0, 4)
substr("aaaadddddfffff", 0)
substr("aaaadddddfffff", 0, 4)
substr("aaaadddddfffff", 1, 4)
substr("aaaadddddfffff", 2, 4)
substr("aaaadddddfffff", 3, 4)
substr("aaaadddddfffff", 4, 4)
substring("aaaadddddfffff", 4, 4)
substring("aaaadddddfffff", 1, 4)
x <- "aaaadddddfffff"
substring(x, 1, 4)
substring(x, 1, 4)  <- "rrr"
x
x <- "aaaadddddfffff"
substr(x, 1, 4)  <- "rrr"
x
substr(x, 1, 4)  <- "errr"
x
substring("abcdef", 1:6, 1:6)
substr("abcdef", 2, 4)
substring("abcdef", 1:6, 1:4)
substring("abcdef", 1:6, 4)
strsplit("abcd")
strsplit("abcd", fixed = T)
strsplit("abcd", fixed = T, split = "")
strsplit("abcd", fixed = F, split = "")
substr(rep("abcdef", 4), 1:4, 4:5)
#########################################################################################
substr(rep("abcdef", 4), 1:4, 4:5)
rep("abcdef", 4)
substr("abcdef", 1:4, 4:5)
substring("abcdef", 1:4, 4:5)
cat("")
cat("\n")
cite()
800000000/(1241952*60)
8000000000/(1241952*60)
107*60
4800/60
1024^2
1100/60
170*8
1360/60
480/3
160*8
1280/60
50000/12
240+30+250+47
setwd("~/master_thesis/Arabidopsis/expression/")
library(stringr)
expression_sim <- read.csv("data/S.csv")
save.image(".RData")
sim_geneID <- readLines("data/gene_names21122.csv")
sim_geneID
View(expression_sim)
expression_sim <- expression_sim + t(expression_sim)
diag(expression_sim) <- 1
rownames(expression_sim)  <- sim_geneID
colnames(expression_sim)  <- sim_geneID
organismicGOfiltered <- read.table("../Blast_Gold_standard/Results/Gen-Gen.edgelist_GS-GO_filtered.txt", col.names=c("Node1", "Node2"))
library(stringr)
x <- as.data.frame(str_match(organismicGOfiltered$Node1, "^(.{9});(.*$)")[,-1])
y <- as.data.frame(str_match(organismicGOfiltered$Node2, "^(.{9});(.*$)")[,-1])
node1 <- x
node2 <- y
colnames(node1) <- c("GeneID", "EC")
colnames(node2) <- c("GeneID", "EC")
rm(x ,y)
x <- as.character(node1$GeneID)
y <- as.character(node2$GeneID)
z <- as.character(rownames(expression_sim))
organismicGOfiltered$expr <- rep(0, times=length(organismicGOfiltered$Node1))
View(organismicGOfiltered)
organismicGOfiltered$expr <- rep(0, times=length(organismicGOfiltered$Node1))
pb <- txtProgressBar(min = 0, max = length(organismicGOfiltered$expr), style = 3)
for(i in 1:length(organismicGOfiltered$expr)) {
ifelse(x[i]%in%z & y[i]%in%z,
organismicGOfiltered$expr[i] <- expression_sim[x[i], y[i]],
organismicGOfiltered$expr[i] <- NA)
setTxtProgressBar(pb, i)
}
close(pb)
write.table(organismicGOfiltered, "results/edgelist_weighted.txt",
col.names=TRUE, row.names=FALSE, quote=FALSE, sep="\t")
